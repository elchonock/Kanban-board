"use strict";function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw i}}}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){l=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}document.addEventListener("DOMContentLoaded",(function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"getItems",value:function(e){var n=t().find((function(t){return t.id==e}));return n?n.items:[]}},{key:"insertItem",value:function(e,r){var o=t(),i=o.find((function(t){return t.id==e})),a={id:Math.floor(1e6*Math.random()),content:r};if(!i)throw new Error("column does not exist");return i.items.push(a),n(o),a}},{key:"updateItem",value:function(e,r){var o,i=t(),a=_slicedToArray(function(){var t,n=_createForOfIteratorHelper(i);try{for(n.s();!(t=n.n()).done;){var r=t.value,o=r.items.find((function(t){return t.id==e}));if(o)return[o,r]}}catch(e){n.e(e)}finally{n.f()}if(!l)throw new Error("no such item")}(),2),l=a[0],s=a[1];if(l.content=null!==(o=r.content)&&void 0!==o?o:l.content,null!=r.columnId&&null!=r.position){var u=i.find((function(e){return e.id==r.columnId}));if(!u)throw new Error("target column not found");s.items.splice(s.items.indexOf(l),1),u.items.splice(r.position,0,l)}n(i)}},{key:"deleteItem",value:function(e){var r,o=t(),i=_createForOfIteratorHelper(o);try{for(i.s();!(r=i.n()).done;){var a=r.value,l=a.items.find((function(t){return t.id==e}));l&&a.items.splice(a.items.indexOf(l),1)}}catch(e){i.e(e)}finally{i.f()}n(o)}}]),e}();function t(){var e=localStorage.getItem("kanban_data");return e?JSON.parse(e):[{id:1,items:[]},{id:2,items:[]},{id:3,items:[]},{id:4,items:[]}]}function n(e){localStorage.setItem("kanban_data",JSON.stringify(e))}var r=function(){function e(t){var n=this;_classCallCheck(this,e),this.root=t,e.columns().forEach((function(e){var t=new o(e.dataId,e.id,e.title);n.root.appendChild(t.elements.root)}))}return _createClass(e,null,[{key:"columns",value:function(){return[{dataId:1,id:"_todo",title:"To Do"},{dataId:2,id:"_inProgress",title:"In Progress"},{dataId:3,id:"_done",title:"Done"},{dataId:4,id:"_delete",title:"Delete"}]}}]),e}(),o=function(){function t(n,r,o){var i=this;_classCallCheck(this,t),this.elements={},this.elements.root=t.createRoot(),this.elements.title=this.elements.root.querySelector(".column__title span"),this.elements.items=this.elements.root.querySelector(".column__items"),this.elements.addBtn=this.elements.root.querySelector(".column__button"),this.elements.root.id=r,this.elements.root.dataset.id=n,this.elements.title.textContent=o,this.elements.addBtn.addEventListener("click",(function(){var t=e.insertItem(n,"");i.renderItem(t)})),e.getItems(n).forEach((function(e){i.renderItem(e)}))}return _createClass(t,[{key:"renderItem",value:function(e){var t=new i(e.id,e.content);this.elements.items.appendChild(t.elements.root)}}],[{key:"createRoot",value:function(){var e=document.createRange();return e.selectNode(document.body),e.createContextualFragment('\n            <div class="board__column column" id="">\n                <h2 class="column__title "> <span></span></h2>\n                <div class="column__content">\n                    <div class="column__items">\n\n                    </div>\n                    <button class="column__button column__item _add">+Add</button>\n                </div>\n            </div>\n\n            ').children[0]}}]),t}(),i=function(){function t(n,r){var o=this;_classCallCheck(this,t),this.elements={},this.elements.root=t.createItemRoot(),this.elements.input=this.elements.root.querySelector(".column__item-input"),this.elements.root.dataset.id=n,this.elements.input.textContent=r,this.content=r;var i=function(){var t=o.elements.input.textContent.trim();t!=o.content&&(o.content=t,e.updateItem(n,{content:o.content}))};this.elements.input.addEventListener("blur",i),this.elements.root.addEventListener("dblclick",(function(){confirm("Are you sure you want to delete this item?")&&(e.deleteItem(n),o.elements.input.removeEventListener("blur",i),o.elements.root.parentElement.removeChild(o.elements.root))}))}return _createClass(t,null,[{key:"createItemRoot",value:function(){var e=document.createRange();return e.selectNode(document.body),e.createContextualFragment('\n            <div class="column__item _draggable" draggable="true">\n                <div class="column__item-input" contenteditable="true"> \n                </div>\n            </div>\n            ').children[0]}}]),t}();new r(document.querySelector(".board__wrapper"))}));